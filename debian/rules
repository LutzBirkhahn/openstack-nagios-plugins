#!/usr/bin/make -f

DEB_VERSION := $(shell dpkg-parsechangelog | egrep '^Version:' | cut -f 2 -d ' ')
DEB_NOEPOCH_VERSION := $(shell echo $(DEB_VERSION) | cut -d: -f2-)
# Gets only the upstream version of the package
DEB_UPSTREAM_VERSION := $(shell echo $(DEB_NOEPOCH_VERSION) | sed 's/-[^-]*$$//')

get-orig-source:
	git archive -o ../openstacknagios_$(DEB_UPSTREAM_VERSION).orig.tar.gz $(DEB_UPSTREAM_VERSION)

%:
	dh $@ --with python2 --buildsystem=python_distutils

override_dh_auto_install:
	python setup.py install --root=debian/python-openstacknagios --install-layout=deb --install-scripts=/usr/lib/nagios/plugins
